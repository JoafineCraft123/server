<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Editor Python Online Simplificado</title>
<style>
  body {
    margin:0; padding:0; background:#1e1e1e; color:#eee; font-family: monospace;
    display: flex; flex-direction: column; height: 100vh;
  }
  textarea {
    flex-grow: 1;
    width: 100%;
    background:#2d2d2d;
    color:#eee;
    border: none;
    padding: 10px;
    font-size: 16px;
    resize: none;
    outline: none;
    box-sizing: border-box;
  }
  #output {
    background:#121212;
    color:#0f0;
    padding: 10px;
    height: 150px;
    overflow-y: auto;
    white-space: pre-wrap;
    font-size: 14px;
    font-family: monospace;
  }
  button {
    background:#0a84ff;
    border:none;
    padding: 10px 15px;
    margin: 5px;
    color:#fff;
    font-weight: bold;
    cursor:pointer;
    border-radius: 4px;
  }
  #controls {
    display: flex;
    justify-content: flex-start;
    padding: 5px 10px;
    background:#252526;
  }
  input[type=text] {
    background:#3c3c3c;
    border:none;
    color:#eee;
    padding: 7px 10px;
    border-radius: 4px;
    margin-left: 5px;
    flex-grow: 1;
    font-family: monospace;
  }
</style>
<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
</head>
<body>

<div id="controls">
  <button id="run">郊윒잺 Rodar C칩digo</button>
  <button id="install">游닍 Instalar Pacote</button>
  <input type="text" id="package-name" placeholder="Nome do pacote para instalar (ex: numpy)" />
</div>

<textarea id="editor" spellcheck="false">
print("Ol치, Python Online!")
</textarea>

<div id="output">(Sa칤da aparecer치 aqui)</div>

<script>
  let pyodide = null;

  async function loadPyodideAndPackages() {
    document.getElementById('output').textContent = "Carregando Python...";
    pyodide = await loadPyodide({
      indexURL: "https://cdn.jsdelivr.net/pyodide/v0.23.4/full/"
    });
    document.getElementById('output').textContent = "Python carregado. Pronto para rodar.";
  }

  async function runCode() {
    if (!pyodide) {
      alert("Python ainda est치 carregando, espere...");
      return;
    }
    const code = document.getElementById('editor').value;
    try {
      // Redireciona sa칤da para capturar
      pyodide.runPython(`
import sys
import io
sys.stdout = io.StringIO()
sys.stderr = sys.stdout
`);
      let result = await pyodide.runPythonAsync(code);
      let output = pyodide.runPython("sys.stdout.getvalue()");
      if (!output.trim() && result !== undefined) output = result.toString();
      document.getElementById('output').textContent = output || "(sem sa칤da)";
    } catch (e) {
      document.getElementById('output').textContent = "Erro:\n" + e;
    }
  }

  async function installPackage() {
    if (!pyodide) {
      alert("Python ainda est치 carregando, espere...");
      return;
    }
    const pkg = document.getElementById('package-name').value.trim();
    if (!pkg) {
      alert("Digite o nome do pacote para instalar.");
      return;
    }
    document.getElementById('output').textContent = `Instalando pacote '${pkg}'...`;
    try {
      await pyodide.loadPackage('micropip');
      await pyodide.runPythonAsync(`import micropip; await micropip.install('${pkg}')`);
      document.getElementById('output').textContent = `Pacote '${pkg}' instalado com sucesso!`;
      document.getElementById('package-name').value = "";
    } catch (e) {
      document.getElementById('output').textContent = `Erro ao instalar '${pkg}':\n${e}`;
    }
  }

  document.getElementById('run').onclick = runCode;
  document.getElementById('install').onclick = installPackage;

  loadPyodideAndPackages();
</script>

</body>
</html>
